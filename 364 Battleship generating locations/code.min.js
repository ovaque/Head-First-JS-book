var view={displayMessage:function(e){document.getElementById("messageArea").innerHTML=e},displayHit:function(e){document.getElementById(e).setAttribute("class","hit")},displayMiss:function(e){document.getElementById(e).setAttribute("class","miss")}},model={boardSize:7,numShips:3,shipsSunk:0,shipLength:3,ships:[{locations:[0,0,0],hits:["","",""]},{locations:[0,0,0],hits:["","",""]},{locations:[0,0,0],hits:["","",""]}],fire:function(e){for(var s=0;s<this.numShips;s++){var t=this.ships[s],i=t.locations.indexOf(e);if(i>=0)return t.hits[i]="hit",view.displayHit(e),view.displayMessage("HIT!"),this.isSunk(t)&&(view.displayMessage("You sank my battleship!"),this.shipsSunk++),!0}return view.displayMiss(e),view.displayMessage("You missed"),!1},isSunk:function(e){for(var s=0;s<this.shipLength;s++)if("hit"!==e.hits[s])return!1;return!0},generateShipLocations:function(){for(var e,s=0;s<this.numShips;s++){do{e=this.generateShip()}while(this.collision(e));this.ships[s].locations=e}},generateShip:function(){var e,s,t=Math.floor(2*Math.random());1===t?(e=Math.floor(Math.random()*this.boardSize),s=Math.floor(Math.random()*(this.boardSize-this.shipLength))):(e=Math.floor(Math.random()*(this.boardSize-this.shipLength)),s=Math.floor(Math.random()*this.boardSize));for(var i=[],n=0;n<this.shipLength;n++)1===t?i.push(e+""+(s+n)):i.push(e+n+""+s);return i},collision:function(e){for(var s=0;s<this.numShips;s++)for(var t=model.ships[s],i=0;i<e.length;i++)if(t.locations.indexOf(e[i])>=0)return!0;return!1}},controller={guesses:0,processGuess:function(e){var s=parseGuess(e);s&&(this.guesses++,model.fire(s)&&model.shipsSunk===model.numShips&&view.displayMessage("You sank all my battleships, in "+this.guesses+" guesses"))}};function parseGuess(e){if(null===e||2!==e.length)alert("Oops, please enter a letter and a number on the board.");else{firstChar=e.charAt(0);var s=["A","B","C","D","E","F","G"].indexOf(firstChar),t=e.charAt(1);if(isNaN(s)||isNaN(t))alert("Oops, that isn't on the board.");else{if(!(s<0||s>=model.boardSize||t<0||t>=model.boardSize))return s+t;alert("Oops, that's off the board!")}}return null}function init(){document.getElementById("fireButton").onclick=handleFireButton,document.getElementById("guessInput").onkeypress=handleKeyPress,model.generateShipLocations()}function handleFireButton(){var e=document.getElementById("guessInput"),s=e.value;controller.processGuess(s),e.value=""}function handleKeyPress(e){var s=document.getElementById("fireButton");if(13===e.keyCode)return s.click(),!1}window.onload=init;